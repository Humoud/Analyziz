const refang=window.refang,defang=window.defang,form_html=document.getElementById("form"),report_html=document.getElementById("report"),output_field=document.getElementById("output"),sample={name:"",size:"",md5:"",sha1:"",sha256:""};var ready_urls;function extractHostname(e){return(e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}function createTable(){const e=document.createElement("table");e.setAttribute("id","dynamic-domains-table"),document.getElementById("lightSwitch").checked?e.setAttribute("class","table table-dark table-sm table-bordered"):e.setAttribute("class","table table-light table-sm table-bordered");var t=e.insertRow(-1);const a=["Url","Search (Domain Only)"];for(var n=0;n<a.length;n++){var r=document.createElement("th");r.innerHTML=a[n],t.appendChild(r)}document.getElementById("domains-table").appendChild(e)}function addRow(e){const t=document.getElementById("dynamic-domains-table"),a=t.rows.length;var n=t.insertRow(a);n=t.insertRow(a);for(var r=0;r<2;r++){var s=document.createElement("td");if(s=n.insertCell(r),0==r){var o=document.createElement("input");o.setAttribute("type","text"),o.setAttribute("value",e),o.setAttribute("class","form-control form-control-sm m-1"),o.readOnly=!0,s.appendChild(o)}else{const t=document.createElement("a"),a=document.createElement("a"),n=document.createElement("a"),r=document.createElement("a"),o=document.createElement("a"),l=document.createElement("a"),d=refang(e);t.setAttribute("href",`https://urlscan.io/search/#domain%3A${extractHostname(d)}`),t.setAttribute("class","btn btn-warning btn-sm m-1"),t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),t.innerHTML="Urlscan",a.setAttribute("href",`https://google.com/search?q=site%3A${extractHostname(d)}`),a.setAttribute("class","btn btn-success btn-sm m-1"),a.setAttribute("target","_blank"),a.setAttribute("rel","noopener noreferrer"),a.innerHTML="Google",n.setAttribute("href",`https://whois.domaintools.com/${extractHostname(d)}`),n.setAttribute("class","btn btn-secondary btn-sm m-1"),n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.innerHTML="Domain Tools",r.setAttribute("href",`https://www.virustotal.com/gui/domain/${extractHostname(d)}`),r.setAttribute("class","btn btn-info btn-sm"),r.setAttribute("target","_blank"),r.setAttribute("rel","noopener noreferrer"),r.innerHTML="VT",o.setAttribute("href",`https://transparencyreport.google.com/safe-browsing/search?url=${extractHostname(d)}`),o.setAttribute("class","btn btn-success btn-sm m-1"),o.setAttribute("target","_blank"),o.setAttribute("rel","noopener noreferrer"),o.innerHTML="SafeBrowsing",l.setAttribute("href",`https://urlhaus.abuse.ch/browse.php?search=${extractHostname(d)}`),l.setAttribute("class","btn btn-secondary btn-sm m-1"),l.setAttribute("target","_blank"),l.setAttribute("rel","noopener noreferrer"),l.innerHTML="URLHause",s.appendChild(t),s.appendChild(a),s.appendChild(n),s.appendChild(r),s.appendChild(o),s.appendChild(l)}}}function copyTextToClipboard(e){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){}),(function(e){console.error("Async: Could not copy text: ",e)})):fallbackCopyTextToClipboard(e)}function handleHashFieldsClick(e){"INPUT"===e.target.tagName?copyTextToClipboard(e.target.value):"I"===e.target.tagName?e.target.parentNode.parentNode.childNodes.forEach((function(e){"INPUT"===e.tagName&&copyTextToClipboard(e.value)})):"SPAN"===e.target.tagName&&e.target.parentElement.childNodes.forEach((function(e){e.attributes&&e.attributes.type&&"text"===e.attributes.type.value&&copyTextToClipboard(e.value)}))}function handleDomains(e){const t=document.getElementById("domains-table");if(t.innerHTML="",e.target.value){if(e.target.value.indexOf(".")>-1){createTable();for(var a=e.target.value.split("\n"),n=0;n<a.length;n++)a[n].indexOf(".")>-1&&addRow(a[n])}t.hidden=!1}}function handleFangRadios(){const e=document.getElementById("domains-textarea"),t=e.value,a=document.querySelector("input[name='defang-refang']:checked").value;"none"===a?ready_urls=t:"defang"===a?ready_urls=defang(t):"refang"===a&&(ready_urls=refang(t)),e.value=ready_urls;const n=new Event("change");e.dispatchEvent(n)}var ready=e=>{"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)};ready((()=>{document.querySelectorAll("[id^=hash-").forEach((function(e){e.addEventListener("click",handleHashFieldsClick)}));if(document.querySelectorAll("input[type=radio][name=defang-refang]").forEach((function(e){e.addEventListener("change",handleFangRadios)})),document.getElementById("domains-textarea").addEventListener("change",handleDomains),window.Worker){const e=document.getElementById("hash-md5"),t=document.getElementById("hash-sha1"),a=document.getElementById("hash-sha256"),n=document.getElementById("vt-md5"),r=document.getElementById("vt-sha1"),s=document.getElementById("vt-sha256"),o=document.getElementById("bazaar-md5"),l=document.getElementById("bazaar-sha1"),d=document.getElementById("bazaar-sha256"),i=new Worker("js/hashworker.min.js");i.onmessage=function(i){sample.md5=i.data.md5,sample.sha1=i.data.sha1,sample.sha256=i.data.sha256,e.value=sample.md5,t.value=sample.sha1,a.value=sample.sha256,n.setAttribute("href",`https://www.virustotal.com/gui/file/${sample.md5}/detection`),r.setAttribute("href",`https://www.virustotal.com/gui/file/${sample.sha1}/detection`),s.setAttribute("href",`https://www.virustotal.com/gui/file/${sample.sha256}/detection`),o.setAttribute("href",`https://bazaar.abuse.ch/browse.php?search=md5:${e.value}`),l.setAttribute("href",`https://bazaar.abuse.ch/browse.php?search=sha1:${t.value}`),d.setAttribute("href",`https://bazaar.abuse.ch/browse.php?search=sha256:${a.value}`)},document.getElementById("sample").addEventListener("change",(function(n){var r=n.target.files[0];sample.name=r.name,sample.size=r.size,e.value="Please wait...",t.value="Please wait...",a.value="Please wait...",i.postMessage(r)}))}document.getElementById("generate").addEventListener("click",(function(e){handleFangRadios();var t="";sample.name&&(t+=`Sample Name: ${sample.name}\nSample Size: ${sample.size}\n\nHashes:\nMD5: ${sample.md5}\nSHA1: ${sample.sha1}\nSHA256: ${sample.sha256}\n\n`),ready_urls&&(t+=`Urls and Domains:\n${ready_urls}\n\n`),form_html.hidden=!0,output_field.value=t;document.getElementById("sample").value;report_html.hidden=!1})),document.getElementById("back").addEventListener("click",(function(e){report_html.hidden=!0,form_html.hidden=!1}))}));
